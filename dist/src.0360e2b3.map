{"version":3,"sources":["framework\\sibor.ts","index.ts"],"names":[],"mappings":"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","file":"src.0360e2b3.map","sourceRoot":"..\\src","sourcesContent":["import { Config }  from \"./config/config\";\r\n\r\ninterface HTMLElementSVG extends HTMLElement {\r\n  contentDocument? : Document\r\n}\r\n\r\nexport class Sibor  {\r\n  protected static _config : Config;\r\n  \r\n  public static get Config() : Config {\treturn this._config; }\r\n  public static set Config(newVal : Config) {\tthis._config = newVal;}\r\n\r\n  protected static _instances : Sibor[] = [];  \r\n  public static get Instances() : Sibor[] {\treturn this._instances; }\r\n  public static set Instances(newVal : Sibor[]) {\tthis._instances = newVal;}\r\n  \r\n  \r\n  protected _contentDocument : Document;  \r\n  public get ContentDocument() : Document {\treturn this._contentDocument; }\r\n\r\n  \r\n  protected _container : HTMLElementSVG;  \r\n  public get Container() : HTMLElementSVG {\treturn this._container; }\r\n\r\n  \r\n  protected _htmlContainer : HTMLElement;  \r\n  public get HTMLContainer() : HTMLElement {\treturn this._htmlContainer; }\r\n\r\n  protected _config : Config;\r\n  \r\n  public get Config() : Config {\treturn this._config; }\r\n  public set Config(newVal : Config) {\tthis._config = newVal;}\r\n\r\n  protected _el : Element;  \r\n  public get El() : Element {\treturn this._el; }\r\n  public set El(newVal : Element) {\tthis._el = newVal; }\r\n\r\n  public get Sibor() {\treturn Sibor; }\r\n\r\n  public get Data() { return this.Config.data; }\r\n  \r\n\r\n  protected _siborEl : HTMLElement | SVGElement;\r\n  \r\n  public get SiborEl() : HTMLElement | SVGElement {\treturn this._siborEl; }\r\n  public set SiborEl(newVal : HTMLElement | SVGElement) {\tthis._siborEl = newVal;}\r\n  \r\n\r\n  public get ElPosition() : DOMRect {\treturn this.Config.mode == \"html\" ? (this.El as any).getBoundingClientRect() : (this.El as any).getBBox(); }\r\n\r\n  protected _rendering : boolean;\r\n  \r\n  public get Rendering() : boolean {\treturn this._rendering; }\r\n  public set Rendering(newVal : boolean) {\tthis._rendering = newVal;}\r\n\r\n  protected _lastRendering : Date;\r\n  \r\n  public get LastRendering() : Date {\treturn this._lastRendering; }\r\n  public set LastRendering(newVal : Date) {\tthis._lastRendering = newVal;}\r\n  \r\n  \r\n  \r\n  \r\n  \r\n\r\n  constructor(elQuery: string, config: Config) {    \r\n    Sibor.Instances.push(this);\r\n\r\n    this.Config = config;\r\n    this.InitConfigWithStaticConfig();    \r\n\r\n    if(!this.Config.data) this.Config.data = {};\r\n\r\n    this.Config.data = this.CreateObservable(this.Config.data, this.Render);\r\n\r\n    this._container = document.getElementById(this.Config.SVG_ID);\r\n    this._contentDocument  = this.Container.contentDocument;\r\n    if(this.ContentDocument)\r\n    {\r\n      this._el = this.ContentDocument.querySelector<HTMLElement | SVGElement>(elQuery);\r\n\r\n      if(this.El)\r\n      {\r\n        if(this.ValidMode())\r\n        {\r\n          this.Render();\r\n        }\r\n      }\r\n      else\r\n      {\r\n        throw new DOMException(`Element could not be found. It seems that the element with the selector '${elQuery}' does not exist.`, \"ElementNotFound\");\r\n      }\r\n    } \r\n    else\r\n    {\r\n      throw new DOMException(`ContentDocument could not be found. It seems that the element with the id (SVG_ID) '${this.Config.SVG_ID}' does not exist.`, \"ContentDocumentNotFound\");\r\n    }\r\n  }\r\n\r\n  public Reset()\r\n  {\r\n    Sibor.Instances.splice(Sibor.Instances.indexOf(this), 1);\r\n    this.SiborEl.parentElement.removeChild(this.SiborEl);\r\n    this.Config = {\r\n      data: {\r\n\r\n      }\r\n    };        \r\n    window.removeEventListener(\"scroll\", this.Event_CallRenderer);\r\n    window.removeEventListener(\"resize\", this.Event_CallRenderer);\r\n\r\n    this._htmlContainer = undefined;\r\n    this._container = undefined;\r\n    this._contentDocument = undefined;\r\n    this._siborEl = undefined;\r\n    this.Rendering = undefined;\r\n    this.LastRendering = undefined;\r\n    this._el = undefined;\r\n  }\r\n\r\n  public CreateObservable(obj, callback : Function): any\r\n  {\r\n    return new Proxy(obj, {\r\n      get: (target, prop, reciever) => {        \r\n        if(typeof target[prop] === \"function\")\r\n        {\r\n          return target[prop].bind(target);\r\n        }\r\n\r\n        return target[prop];\r\n      },\r\n      set: (target, prop, value) => {\r\n                \r\n        if(target[prop] !== value)\r\n        {\r\n          \r\n          target[prop] = value; \r\n          callback.apply(this);\r\n        }\r\n        else\r\n        {\r\n        }\r\n        \r\n        return target[prop];\r\n      },\r\n      construct() {\r\n        return obj;\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n\r\n  public InitConfigWithStaticConfig()\r\n  {\r\n    for(const key in Sibor.Config)\r\n    {\r\n      if(key && (Sibor.Config[key] || Sibor.Config[key] === false) && (!this.Config[key] || !this.Config[key] === true))\r\n      { //if static Config contains key but local Config does not\r\n        this.Config[key] = Sibor.Config[key];\r\n      }\r\n    }\r\n  }\r\n\r\n  protected Event_CallRenderer(e)\r\n  {    \r\n    this.Render();\r\n  }\r\n\r\n  public InitHTMLContainer()\r\n  {\r\n    const id = \"Sibor_HTMLContainer__\" + this.Config.SVG_ID;\r\n    const foundHTMLContainer : HTMLElement = document.querySelector(`#${id}`);\r\n    if(!foundHTMLContainer)\r\n    {\r\n        this._htmlContainer = this.HtmlToElement(`\r\n        <div style='position: absolute; background: transparent; border: none; margin: 0; padding: 0; pointer-events: none; z-index: 99999;transition: all 0.3s ease-in-out;'>\r\n          <!-- This container will be align over the svg contentDocument. All overlayed items (mode = 'html') will be playced here. -->\r\n          <div id='${id}' style='position: relative; width: 100%; height: 100%;'>\r\n          </div>\r\n        </div>\r\n        `).children[0] as HTMLElement;\r\n      document.body.appendChild(this.HTMLContainer.parentElement);\r\n\r\n\r\n\r\n      window.addEventListener(\"scroll\", this.Event_CallRenderer.bind(this));\r\n      window.addEventListener(\"resize\", this.Event_CallRenderer.bind(this));\r\n    }\r\n    else\r\n    {\r\n      this._htmlContainer = foundHTMLContainer;\r\n    }    \r\n    \r\n  }\r\n\r\n\r\n\r\n  public ValidMode() : boolean\r\n  {\r\n    switch (this.Config.mode) \r\n    {\r\n      case \"html\": \r\n      case \"svg\":\r\n      case \"text\":\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n\r\n  public Render(causedByTimeout? : boolean)\r\n  {         \r\n    if(this.Rendering) return;\r\n\r\n    \r\n    this.Rendering = true; \r\n    this.LastRendering = new Date();\r\n\r\n    this.UpdateSiborEl();\r\n    switch (this.Config.mode) \r\n    {\r\n      case \"html\": \r\n        this.DrawHTML();\r\n        break;\r\n      case \"svg\":\r\n        this.DrawSVG();\r\n        break;\r\n      case \"text\":\r\n        this.ReplaceText();\r\n        break;\r\n      default:\r\n        return false;\r\n    }\r\n    this.Rendering = false;\r\n    setTimeout( () => {\r\n      const now = Date.now();\r\n      const diff = now - this.LastRendering.getTime();\r\n      \r\n      if(diff >= 450 && !causedByTimeout)\r\n      {\r\n        this.Render(true);\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  /**\r\n   * @param {String} HTML representing a single element\r\n   * @return {Node}\r\n   */\r\n  protected HtmlToElement(html) : HTMLElement\r\n  {\r\n    var template = document.createElement('template');\r\n    html = html.trim(); // Never return a text node of whitespace as the result\r\n    template.innerHTML = html;\r\n    return template.content.firstChild as HTMLElement;\r\n  }\r\n\r\n  /**\r\n    * @param {String} HTML representing any number of sibling elements\r\n    * @return {NodeList} \r\n    */\r\n  protected HtmlToElements(html): NodeList \r\n  {\r\n    var template = document.createElement('template');\r\n    template.innerHTML = html;\r\n    return template.content.childNodes;\r\n  }\r\n\r\n  public PositionHTMLContainer()\r\n  {        \r\n    const absContainerPos = this.Container.getBoundingClientRect();\r\n\r\n    if(this.HTMLContainer.parentElement.style.top != `${absContainerPos.top + window.scrollY}px`)\r\n      this.HTMLContainer.parentElement.style.top = `${absContainerPos.top + window.scrollY}px`;\r\n    if(this.HTMLContainer.parentElement.style.left != `${absContainerPos.left + window.scrollX}px`)\r\n      this.HTMLContainer.parentElement.style.left = `${absContainerPos.left + window.scrollX}px`;\r\n    if(this.HTMLContainer.parentElement.style.width != `${absContainerPos.width}px`)\r\n      this.HTMLContainer.parentElement.style.width = `${absContainerPos.width}px`;\r\n    if(this.HTMLContainer.parentElement.style.height != `${absContainerPos.height}px`)\r\n      this.HTMLContainer.parentElement.style.height = `${absContainerPos.height}px`;\r\n  }\r\n\r\n  public PositionElement(el : HTMLElement | SVGElement) {    \r\n    el.id = `Sibor_${this.El.id}`;\r\n    el.style.position = \"absolute\";\r\n    el.style.pointerEvents= \"auto\";\r\n    const pos = this.ElPosition;\r\n    el.style.top = `${this.ElPosition.top}px`;\r\n    el.style.left = `${this.ElPosition.left}px`;\r\n    el.style.border = \"1px solid red\";\r\n    el.style.maxWidth = `${this.ElPosition.width}px`;\r\n    el.style.maxHeight = `${this.ElPosition.height}px`;    \r\n  }\r\n\r\n  public DrawHTML()\r\n  {\r\n    this.InitHTMLContainer();\r\n    this.PositionHTMLContainer();      \r\n\r\n    // this.UpdateSiborEl();   \r\n\r\n    this.PositionElement(this.SiborEl);\r\n    \r\n    if(!this.HTMLContainer.querySelector(`#${this.SiborEl.id}`))\r\n    {\r\n      this.HTMLContainer.appendChild(this.SiborEl);   \r\n    }\r\n\r\n  }\r\n\r\n  public UpdateHTMLSiborEl()\r\n  {\r\n    if(!this.Config.template)\r\n    {\r\n      this.Config.template = `\r\n        <div style='width: 100%; height: 100%; overflow: hidden;'></div>\r\n      `;\r\n    }\r\n    let nextSiborEl = null;\r\n\r\n    if(!this.SiborEl)\r\n    {\r\n      if(this.Config.template.startsWith(\"#\") )\r\n      {      \r\n        const template : HTMLTemplateElement = document.querySelector(this.Config.template).cloneNode(true) as HTMLTemplateElement;\r\n        \r\n        nextSiborEl = template.content.firstElementChild as HTMLElement;\r\n      }\r\n      else\r\n      {\r\n        const htmlStr: string = this.Config.template;\r\n\r\n        const el : HTMLElement = this.HtmlToElement(htmlStr);   \r\n        nextSiborEl = el;   \r\n      }  \r\n    }\r\n\r\n    if(nextSiborEl) this.SiborEl = nextSiborEl; \r\n  }\r\n\r\n  public UpdateSiborEl()\r\n  {\r\n    switch(this.Config.mode)\r\n    {\r\n      case \"html\":\r\n        this.UpdateHTMLSiborEl();\r\n        break;\r\n      case \"svg\":\r\n      case \"text\":\r\n        this.SiborEl = this.El as SVGElement;\r\n        break;\r\n    }\r\n\r\n       \r\n  }\r\n  \r\n\r\n  public DrawSVG()\r\n  {  \r\n    //TODO: Change this so that template can also contain an id to an template element\r\n    const svgStr : string = this.Config.template;\r\n\r\n    if(this.El.tagName !== \"g\")\r\n    {\r\n      var xmlns = \"http://www.w3.org/2000/svg\";\r\n      \r\n\r\n      const g = document.createElementNS (xmlns, \"g\");\r\n      g.setAttributeNS(null, \"transform\", `translate(${this.ElPosition.x}, ${this.ElPosition.y})`);\r\n      g.innerHTML = this.El.outerHTML;\r\n      g.innerHTML += svgStr;\r\n\r\n      const elOld = this.El;\r\n      const elParent = this.El.parentElement;\r\n      elOld.remove();\r\n      this._el = g;      \r\n      elParent.appendChild(this.El);\r\n      (this.El.firstChild as Element).setAttributeNS(null, \"x\", \"0\");\r\n      (this.El.firstChild as Element).setAttributeNS(null, \"y\", \"0\");\r\n    }\r\n    else\r\n    {\r\n      this.El.innerHTML += svgStr;\r\n    }\r\n  }\r\n\r\n\r\n  public ReplaceText()\r\n  {\r\n    let str = this.El.innerHTML;\r\n    const datasetText = (this.El as HTMLElement).dataset.text ? (this.El as HTMLElement).dataset.text : false;    \r\n    if(datasetText)\r\n    {\r\n      str = datasetText;\r\n    }\r\n    else\r\n    {\r\n      (this.El as HTMLElement).dataset.text = str;\r\n    }\r\n\r\n    const strMatches : string[] = str.match(/({{[a-zA-Z_$][a-zA-Z_$0-9]*}})/gi);\r\n    const strMatchesOrig : string[] = strMatches;\r\n\r\n    \r\n\r\n    for(const strMatch of strMatches)\r\n    {\r\n      const key = strMatch.replace(\"{{\", \"\").replace(\"}}\", \"\");\r\n      const value = this.Config.data[key];\r\n      \r\n      if(value !== undefined)\r\n      {\r\n        str = str.replace(strMatch, value.toString());\r\n      }\r\n      else\r\n      {\r\n      }\r\n    }\r\n    this.El.innerHTML = str;\r\n    \r\n  }\r\n}","import \"./main.scss\";\r\nimport { Sibor } from \"./framework/sibor\";\r\n\r\n\r\nwindow.onload = function() {  \r\n  Sibor.Config = {\r\n    SVG_ID: \"test_SVG\"\r\n  };\r\n\r\n\r\n  (<any>window).rect_top_left = new Sibor(\"#rect_top_left\", {\r\n    mode: \"html\",\r\n    template: \"#tmpl_test\"\r\n  });\r\n  console.log((<any>window).rect_top_left);\r\n  \r\n\r\n  (<any>window).rect_bottom_right = new Sibor(\"#rect_bottom_right\", {\r\n    mode: \"svg\", //html, text, svg\r\n    template: `\r\n      <text x='5' y='20'>Hello Judith</text>\r\n    `\r\n  });\r\n  console.log((<any>window).rect_bottom_right);\r\n\r\n\r\n  (<any>window).text_top_right = new Sibor(\"#text_top_right\", {\r\n    mode: \"text\",\r\n    data: {\r\n      jahre: 20,\r\n      hoehe: 180\r\n    }\r\n  });\r\n  console.log((<any>window).text_top_right);\r\n\r\n}\r\n"]}